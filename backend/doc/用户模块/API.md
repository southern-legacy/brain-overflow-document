# 用户认证模块
## 注册功能
-  请求路径：`usr/signup`
- 功能：创建一个用户
- 是否受到保护：否
- 请求方法：POST
- 接受参数：json 对象
- 请求体的 mime-type: `application/json`
```json
{
	"name": "string",     // 必须
	"email": "string",    // 非必须
	"phone": "string",    // 非必须，但和上面的必须二选一
	"passwd": "string",   // 必须
}
```

> [!info]
> `email` 和 `phone` 字段二选一
> 
> 前端传过来之前最好验证一下是否符合邮件和电话号码格式（电话号码格式采用 E164 格式，就是由国家前缀，如中国 +86 那种，并且中间没有空格）


- 返回内容：

|     条件      | 响应码 |                    表头内容                     |  报文内容   |
| :---------: | :-: | :-----------------------------------------: | :-----: |
|    成功注册     | 201 | `Location: /usr/info/${id}`, 这个路径可以获取用户详细信息 | jwt 字符串 |


## 登录功能
- 请求路径：`usr/login`
- 功能：处理一个账户登录请求
- 是否收到保护：否
- 接收参数：请求体内的 json 对象
- 请求方法：POST
- 请求体的 mime-type: `application/json`
```json
{
	"id": 123,          // 非必须
	"email": "string",    // 非必须
	"phone": "string",    // 非必须，但和上面的必须三选一
	"passwd": "string",   // 必须
}
```

> [!info]
> `id`, `email` `phone`  字段三选一，同样需要校验，格式同上

|     条件      | 响应码 | 表头内容 |  报文内容   |
| :---------: | :-: | :--: | :-----: |
|    成功登录     | 200 |      | jwt 字符串 |
|   密码账号不匹配   | 401 |      |         |
|     无账号     | 401 |      |         |


## 注销功能
- 请求路径：`usr/delete_account`
- 功能：处理一个账户注销请求
- 是否收到保护：是，需要一个使用 `Bearer token` 承载的 jwt
- 接收参数：请求体内的密码字符串
- 请求方法：POST
- 请求体的 mime-type: `text/plain`
- 相应内容

|     条件      | 响应码 | 表头内容 |  报文内容   |
| :---------: | :-: | :--: | :-----: |
|    成功删除     | 200 |      | jwt 字符串 |
|   密码账号不匹配   | 401 |      |         |
|     无账号     | 401 |      |         |


## JWT 内容

### 头部

```json
{
  "typ": "JWT",
  "alg": "HS256"
}
```

此处选用 `HS256` 算法

### 负载

```json
{
  "id": 2,
  "name": "Sylvan Lyon",
  "email": "sylvanlyon@gmail.com",
  "phone": null,
  "exp": 1754696343
}
```

返回字段包含 `id`、`name`、`email`、`phone` 和 `exp`。其中  `exp` 为 `token` 过期时间，目前默认是 12 小时后，默认拥有 60 秒的宽限期